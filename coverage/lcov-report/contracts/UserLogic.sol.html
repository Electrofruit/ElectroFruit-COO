<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/UserLogic.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> UserLogic.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">53.85% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>14/26</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">50% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>15/30</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">70% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>14/20</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">57.5% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>23/40</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">36×</span>
<span class="cline-any cline-yes">36×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">22×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">101×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// Copyright 2018 Energy Web Foundation
// This file is part of the Origin Application brought to you by the Energy Web Foundation,
// a global non-profit organization focused on accelerating blockchain technology across the energy sector, 
// incorporated in Zug, Switzerland.
//
// The Origin Application is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
// This is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY and without an implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details, at &lt;http://www.gnu.org/licenses/&gt;.
//
// @authors: slock.it GmbH, Martin Kuechler, martin.kuchler@slock.it
&nbsp;
pragma solidity ^0.4.18;
&nbsp;
import "./UserDB.sol";
import "./RoleManagement.sol";
import "./CoO.sol";
import "./Updatable.sol";
import "./RolesInterface.sol";
&nbsp;
/// @title The logic-contract for the user-data
/// @notice this contract will not directly store any data, instead it will store them into the userDB-contract
contract UserLogic is RoleManagement, Updatable, RolesInterface {
    /// @notice db user-db for storing the contract
    UserDB public db;
&nbsp;
    modifier isInitialized {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(address(db) != 0x0);
        _;
    }
&nbsp;
    /// @notice constructor 
    /// @param _coo address of the Certificate Registry contract (CoO.sol)
    /// @dev it will also call the RoleManagement-constructor 
    function UserLogic(CoO _coo) RoleManagement(_coo) public {
    }
&nbsp;
    /// @notice Initialises the contract by binding it to a logic contract
    /// @param _database Sets the logic contract
    function init(address _database) external {
        require(db == UserDB(0x0) &amp;&amp; cooContract.owner() == msg.sender);
        db = UserDB(_database);
    }
&nbsp;
    /// @notice funciton that can be called to create a new user in the storage-contract, only executable for user-admins!
    /// @notice if the user does not exists yet it will be creates, otherwise the older userdata will be overwritten
    /// @param _user address of the user
    /// @param _firstName first name of the user
    /// @param _surname surname of the user
    /// @param _organization organization the user is representing
    /// @param _street streetname 
    /// @param _number housenumber
    /// @param _zip zip-code
    /// @param _city city-name
    /// @param _country country-name
    /// @param _state state
    function setUser(        
        address _user, 
        bytes32 _firstName, 
        bytes32 _surname, 
        bytes32 _organization,
        bytes32 _street,
        bytes32 _number,
        bytes32 _zip,
        bytes32 _city,
        bytes32 _country,
        bytes32 _state
    ) 
        external 
        onlyRole(RoleManagement.Role.UserAdmin) 
        isInitialized
    {  
        require(_user != address(0x0)
            &amp;&amp; _firstName != 0x0 &amp;&amp; _surname != 0x0 
            &amp;&amp; _organization != 0x0 
            &amp;&amp; _city != 0x0 &amp;&amp; _street != 0x0 &amp;&amp; _number &gt; 0 &amp;&amp; _zip != 0x0 &amp;&amp; _country != 0x0
        );    
        db.setUser( _user, _firstName, _surname, _organization, _street, _number, _zip, _city, _country, _state);   
&nbsp;
    }
&nbsp;
    /// @notice function to deactive an use, only executable for user-admins
    /// @param _user the user that should be deactivated
    function deactivateUser(address _user)
        public
        onlyRole(RoleManagement.Role.UserAdmin)
        isInitialized
    {
        require(!isRole(RoleManagement.Role.TopAdmin,_user) 
            &amp;&amp; !isRole(RoleManagement.Role.UserAdmin,_user) 
            &amp;&amp; !isRole(RoleManagement.Role.AssetAdmin,_user)
            &amp;&amp; !isRole(RoleManagement.Role.AgreementAdmin,_user)
        );
&nbsp;
        db.setUserActive(_user, false);
    }
        
    /// @notice function to set / edit the rights of an user / account, only executable for Top-Admins!
    /// @param _user user that rights will change
    /// beware: if the only TopAdmin revokes its own rights noone will be able to get TopAdmin-rights back, making it impossible to set any new admin-rights
    /// @param _rights rights encoded as bitmask
    function setRoles(address _user, uint _rights) 
        public 
        onlyRole(RoleManagement.Role.UserAdmin)
        isInitialized
       userExists(_user)
    {
        db.setRoles(_user, _rights);
    }
&nbsp;
    /// @notice fallback
<span class="fstat-no" title="function not covered" >    function () publi</span>c {
<span class="cstat-no" title="statement not covered" >        revert()</span>;
    }
&nbsp;
    /// @notice function to update the logic of a smart contract
    /// @param _newLogic contract-address of the new smart contract, replacing the currently active one
    function update(address _newLogic) 
        external
        onlyAccount(address(cooContract))
        isInitialized
    {
        db.changeOwner(_newLogic);
    }
&nbsp;
    /// @notice function to return all the data of an user
    /// @param _user user 
    /// @return returns firstName, surname, organization, street, number, zip, city, country, state, roles and the active-flag
    function getFullUser(address _user)
        public
        view 
        returns (
            bytes32 firstName,
            bytes32 surname,
            bytes32 organization,
            bytes32 street,
            bytes32 number,
            bytes32 zip,
            bytes32 city,
            bytes32 country,
            bytes32 state,
            uint roles,
            bool active
        )
    {
        return db.getFullUser(_user);
    }
&nbsp;
    /// @notice function to change the name of an user
    /// @param _user ethereum-account of that user
    /// @param _firstName new first name
    /// @param _surname new surname
    function setUserName(address _user, bytes32 _firstName, bytes32 _surname) 
        external
        onlyRole(RoleManagement.Role.UserAdmin) 
    {   
        require(_firstName != 0x0 &amp;&amp; _surname != 0x0);
        db.setUserName(_user, _firstName, _surname);
    }
&nbsp;
&nbsp;
    /// @notice function set change the name of an organization
    /// @param _user ethereum-address of an user / organization
    function setOrganization(address _user, bytes32 _organization) 
        external 
        onlyRole(RoleManagement.Role.UserAdmin) 
&nbsp;
    {
        require(_organization != 0x0);
        db.setOrganization(_user,_organization);
    }
&nbsp;
    /// @notice function to set a new address for an existing organization 
    /// @param _user ethereum-address of the organization
    /// @param _street new streetname
    /// @param _number new number
    /// @param _zip new zip-code
    /// @param _city new city
    /// @param _country new country
    /// @param _state new state
    function setOrganizationAddress(address _user, bytes32 _street, bytes32 _number, bytes32 _zip, bytes32 _city, bytes32 _country, bytes32 _state)
        external
        onlyRole(RoleManagement.Role.UserAdmin) 
    {
        require(_city != 0x0 &amp;&amp; _street != 0x0 &amp;&amp; _number &gt; 0 &amp;&amp; _zip != 0x0 &amp;&amp; _country != 0x0);
        db.setAddress(_user, _street, _number, _zip, _city, _country, _state);
    }
    
    /// @notice function that checks if there is an user for the provided ethereum-address
    /// @param _user ethereum-address of that user
    /// @return bool if the user exists
    function doesUserExist(address _user) 
        public 
        view 
        returns (bool) 
    {
        return db.doesUserExist(_user);
    }
&nbsp;
    /// @notice function to retrieve the rights of an user
    /// @dev if the user does not exist in the mapping it will return 0x0 thus preventing them from accidently getting any rights
    /// @param _user user someone wants to know its rights
    /// @return bitmask with the rights of the user
    function getRolesRights(address _user) 
        public 
        view 
        returns (uint) 
    {
        return db.getRolesRights(_user);
    }
&nbsp;
    function addAdminRole(address _user, RoleManagement.Role role)
        public 
        userExists(_user)
        onlyRole(RoleManagement.Role.TopAdmin) 
    {
        <span class="missing-if-branch" title="else path not taken" >E</span>if ((role == RoleManagement.Role.TopAdmin || role == RoleManagement.Role.UserAdmin 
        || role == RoleManagement.Role.AssetAdmin || role == RoleManagement.Role.Trader)
     //   &amp;&amp; role != RoleManagement.Role.Trader &amp;&amp; role != RoleManagement.Role.AssetManager
        ) {
           
            <span class="missing-if-branch" title="else path not taken" >E</span>if (!isRole(role,_user)) {
                uint roles = db.getRolesRights(_user);
                db.setRoles(_user, roles + uint(2) ** uint(role));
            }
        }
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function removeAdminRole(address _user, RoleManagement.Role role)</span>
        public 
        userExists(_user)
        onlyRole(RoleManagement.Role.TopAdmin) 
    {
<span class="cstat-no" title="statement not covered" >        if ((role == RoleManagement.Role.TopAdmin || role == RoleManagement.Role.UserAdmin </span>
        || role == RoleManagement.Role.AssetAdmin || role == RoleManagement.Role.Trader)
      ) {
<span class="cstat-no" title="statement not covered" >            if (isRole(role,_user)) {</span>
<span class="cstat-no" title="statement not covered" >                uint roles = db.getRolesRights(_user)</span>;
                db.setRoles(_user, roles - uint(2) ** uint(role));
            }
        }
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function addAssetManagerRole(address _user)</span>
        public
        userExists(_user)
        onlyRole(RoleManagement.Role.AssetAdmin) 
    {
<span class="cstat-no" title="statement not covered" >        if (!isRole(RoleManagement.Role.AssetManager,_user)) {</span>
<span class="cstat-no" title="statement not covered" >            uint roles = db.getRolesRights(_user)</span>;
            db.setRoles(_user, roles + uint(2) ** uint(RoleManagement.Role.AssetManager));
        }
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function removeAssetManagerRole(address _user)</span>
        public
        userExists(_user)
        onlyRole(RoleManagement.Role.AssetAdmin) 
    {
<span class="cstat-no" title="statement not covered" >        if (isRole(RoleManagement.Role.AssetManager,_user)) {</span>
<span class="cstat-no" title="statement not covered" >            uint roles = db.getRolesRights(_user)</span>;
            db.setRoles(_user, roles - uint(2) ** uint(RoleManagement.Role.AssetManager));
        }
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function addTraderRole(address _user)</span>
        public
        userExists(_user)
        onlyRole(RoleManagement.Role.AgreementAdmin) 
    {
<span class="cstat-no" title="statement not covered" >        if (!isRole(RoleManagement.Role.Trader,_user)) {</span>
<span class="cstat-no" title="statement not covered" >            uint roles = db.getRolesRights(_user)</span>;
            db.setRoles(_user, roles + uint(2) ** uint(RoleManagement.Role.Trader));
        }
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function removeTraderRole(address _user)</span>
        public
        userExists(_user)
        onlyRole(RoleManagement.Role.AgreementAdmin) 
    {
<span class="cstat-no" title="statement not covered" >        if (isRole(RoleManagement.Role.Trader,_user)) {</span>
<span class="cstat-no" title="statement not covered" >            uint roles = db.getRolesRights(_user)</span>;
            db.setRoles(_user, roles - uint(2) ** uint(RoleManagement.Role.Trader));
        }
    }
    
&nbsp;
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Feb 16 2018 09:52:39 GMT+0100 (CET)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
